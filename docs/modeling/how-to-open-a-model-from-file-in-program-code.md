---
title: 'Gewusst wie: Öffnen eines Modells aus einer Datei im Programmcode'
description: Erfahren Sie, dass der ModelBus Standardverfahren für das verweisen auf ein Modell oder Elemente in einem Modell und das Auffinden des Modells, wenn es verschoben wurde, bereitstellt.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
author: JoshuaPartlow
ms.author: joshuapa
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: f854edc45724f0e1f3db5bda22cb6aa006d77e60
ms.sourcegitcommit: 4d394866b7817689411afee98e85da1653ec42f2
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/12/2020
ms.locfileid: "97363873"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Gewusst wie: Öffnen eines Modells aus einer Datei im Programmcode

DSL-Modelle können in jeder beliebigen Anwendung geöffnet werden.

In einer Visual Studio-Erweiterung können Sie ModelBus zu diesem Zweck verwenden. ModelBus bietet Standardverfahren zum Verweisen auf ein Modell oder auf Elemente in einem Modell und zum Auffinden des Modells, wenn es verschoben wurde. Weitere Informationen finden Sie unter [integrieren von Modellen mit Visual Studio-ModelBus](../modeling/integrating-models-by-using-visual-studio-modelbus.md).

## <a name="target-framework"></a>Zielframework

Legen Sie das **Ziel Framework** des Anwendungs Projekts auf .NET Framework 4 oder höher fest.

1. Öffnen Sie das Visual Studio-Projekt für die Anwendung, in der Sie ein DSL-Modell lesen möchten.

2. Klicken Sie in **Projektmappen-Explorer** mit der rechten Maustaste auf das Projekt, und klicken Sie dann auf **Eigenschaften**.

3. Legen Sie im Fenster Projekteigenschaften auf der Registerkarte **Anwendung** das Feld **Ziel Framework** auf **.NET Framework 4** (oder höher) fest.

> [!NOTE]
> Das Ziel Framework sollte nicht **.NET Framework 4 Client Profil** sein.

## <a name="references"></a>References

Fügen Sie dem Visual Studio-Anwendungsprojekt diese Verweise hinzu:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - Wenn dies im Dialogfeld **Verweise hinzufügen** auf der Registerkarte **.net** nicht angezeigt wird, klicken Sie auf die Registerkarte **Durchsuchen** , und navigieren Sie zu `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\` .

- Ihre DSL-Assembly, die Sie im Ordner "bin" Ihres DSL-Projekts finden. Der Name hat in der Regel folgendes Format: *yourcompany*. *Yourproject* `.Dsl.dll` .

## <a name="important-classes-in-the-dsl"></a>Wichtige Klassen in der DSL

Bevor Sie den Code schreiben können, der die DSL liest, sollten Sie die Namen einiger der von ihrer DSL generierten Klassen kennen. Öffnen Sie in ihrer DSL-Projekt Mappe das **DSL** -Projekt, und suchen Sie im Ordner **generatedcode** nach. Alternativ können Sie auf die DSL-Assembly in den Projekt **verweisen** doppelklicken und den DSL-Namespace in **Objektkatalog** öffnen.

Dabei handelt es sich um die Klassen, die Sie identifizieren sollten:

- *Yourdslrootclass* : Dies ist der Name der Stamm Klasse in Ihrem `DslDefinition.dsl` .

- *Yourdslname* `SerializationHelper` : Diese Klasse wird in `SerializationHelper.cs` in Ihrem DSL-Projekt definiert.

- *Yourdslname* `DomainModel` : Diese Klasse wird in `DomainModel.cs` in Ihrem DSL-Projekt definiert.

## <a name="read-from-a-file"></a>Lesen aus einer Datei

Das folgende Beispiel dient zum Lesen einer DSL, in der die wichtigsten Klassen folgendermaßen aussehen:

- Familytreemodel

- Familytreeserializationhelper

- Familytreedomainmodel

Die andere Domänen Klasse in dieser DSL ist Person.

```csharp
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="save-to-a-file"></a>In einer Datei speichern

Durch die folgende Ergänzung zum vorherigen Code wird das Modell geändert und dann in einer Datei gespeichert.

```csharp
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```
